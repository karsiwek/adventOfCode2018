package karsiwek.day13

var input: String = """
/->-\
|   |  /----\
| /-+--+-\  |
| | |  | v  |
\-+-/  \-+--/
  \------/
""".trimIndent()

var input2 = """
                                                                 /-----------------------------------------------------------------------\
              /----------\                                       |                             /-----------------------------------------+---------\
              |          |            /--------------------------+-----\ /---------------------+----------------------------------\      |         |
            /-+----------+-----\      |                 /--------+-----+-+---------------------+----------------------------------+------+---\     |
    /-------+-+--\       |     |      |                 |  /-----+-----+-+---------------------+-------------------\              |      |   |     |
    |       | |  |       |     |      |                 |  |     |     | |   /-----------------+-\   /-------------+\             |      |   |     |
    |       | |  |/------+-----+---\  |               /-+--+-----+-----+-+---+-----------------+-+---+---------\   ||             |      |   |     |
    |       | |  ||      |     |   |  |             /-+-+--+----<+-----+-+---+-----------------+-+---+---------+---++-------------+----\ |   |     |
    |       | |  ||      |    /+---+--+------------\| | |  |     |     | |   |                 | |   |         |   ||             |    | |   |     |
    |       | |  ||      |    ||   |  |          /-++-+-+--+-----+-----+-+---+-----------------+-+---+---------+-\ ||             |    | |   |     |
    |       | | /++------+----++---+--+----------+-++-+-+--+-----+-----+-+---+-----------------+-+---+-------\ | | ||             |    | |   |     |
    |       | | |||      |/---++---+--+----------+-++-+-+--+\    |     | |   |                 | |   |       | | | ||             |    | |   |     |
    |       | | |||      ||  /++---+--+----------+-++-+-+--++\   |     | |  /+----------\      | |   |       | | | ||             |    | |   |     |
    |   /---+-+-+++------++--+++---+--+----------+-++-+-+--+++---+-\   | \--++----------+------+-+---+-------+-+-+-++-------------/    | |   |     |
    |/--+---+-+-+++------++--+++---+--+--\      /+-++-+-+--+++---+-+---+----++----------+------+-+---+-------+-+-+-++------------------+-+\  |     |
    ||  |   | | |||      ||  |||   | /+--+------++-++-+-+--+++---+-+---+----++--------\ |      | |   |   /---+-+-+-++------------------+-++--+-\   |
    ||  |   | | |||      ||  |||  /+-++--+------++-++-+-+--+++---+-+\  |    ||        | |      | |   \---+---+-+-+-+/                  | ||  | |   |
    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  /+-++--+----++--------+\|      | |      /+---+-+-+-+-------\           | ||  | |   |
    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  || ||  |    ||     /--+++-----\| |      ||   | | | |       |           | ||  | |   |
    ||  |   | | |||      ||  |||  || ||  |      || || | |  |||  || ||  |    ||     |  |||     || |      ||   | | | |       |       /---+-++--+-+--\|
    ||/-+---+-+-+++\     ||  |||  || ||  |      || || | |/-+++--++-++--+----++-----+--+++-----++-+------++---+-+-+-+\      |       |   | ||  | |  ||
    ||| |   | | ||||     ||  |||  || ||  |      || || | || |||  || ||  |    ||     | /+++-----++-+------++>--+-+-+-++-\    |       |   | ||  | |  ||
    ||| \---+-+-++++-----++--+++--++-++--+------++-++-+-++-+++--++-/|  |    ||     | ||||     ||/+------++---+-+-+-++-+---\|       |   | ||  | |  ||
    |||     | | ||||     ||  |||  || ||  |      || || | || |||  ||  |  |    ||     | ||||     ||||      ||   | | | || |   ||       |   | ||  | |  ||
    |||     | | ||||     ||  |||  || ||  |/-----++-++-+-++-+++-\||  |  |    ||     | ||||     ||||      ||   | | | || |   ||       |   | ||  | |  ||
    |||     | | ||||  /--++--+++--++-++--++-----++-++-+-++-+++-+++--+--+----++-----+-++++-----++++------++---+-+-+-++-+---++------\|   | ||  | |  ||
    \++-----+-+-+/||  |  ||  |||  || |\--++-----++-++-+-++-+++-+++--+--/    ||     | ||||     ||||      ||   | | | || |   ||      ||   | ||  | |  ||
     ||     | | | ||  |  ||  |||  || |   ||     v| || | || ||| |||  |       ||     | ||||     ||||      ||   | | | || |   ||    /-++---+-++--+-+-\||
     ||     | | | ||  |  ||  |||  || |   ||     || ||/+-++-+++-+++--+-\     ||     | ||||     ||||      ||   | | | || |   ||    | ||   | ||  | | |||
     ||     | | | ||  |  ||  |\+--++-+---++-----++-/||| || ||| |||  | |     ||     | ||||     ||||      ||   | |/+-++-+---++----+-++---+-++--+\| |||
     ||     | | | ||  |  ||  | |  || |   ||     ||  ||| || ||| |||  | |     ||     | ||||     ||||      \+---+-+++-++-+---+/    | ||   | ||  ||| |||
     ||/----+-+-+-++--+--++--+-+--++-+---++-----++--+++-++-+++-+++--+-+-----++-----+-++++---\ ||||  /----+---+-+++-++-+---+-----+-++---+-++-\||| |||
     |||  /-+-+-+-++--+--++--+-+--++-+---++-----++--+++-++-+++-+++--+-+-----++-----+-++++---+-++++--+----+--\| ||| || |   |     | |\---+-++-++++-+/|
     |||  | | | | ||  |  ||  | |  || |   ||     ||  ||| || ||| |||  | |    /++-----+-++++---+-++++--+----+--++-+++-++-+---+-----+-+-\  | || |||| | |
     |||  | | \-+-++--+--/|  | |  || |   ||     ||  ||| || ||| |||  | |    |||     | ||||   | ||||  |    |  || ||| || |   |     | | |  | || |||| | |
     |||  | |   | ||  |   |  | |  || |   ||     ||  ||| || ||| |||  | |    |||     | ||||   | |\++--+----+--++-+++-++-+---+-----+-+-+--+-++-++++-+-/
     |||  | \---+-++--+---+--+-/  || |   |\-----++--+++-++-+++-/||  | |    |||     | ||||   | | ||  |    |  || ||| || |   |     | | |  | || |||| |
     |||  | /---+-++--+---+--+\   \+-+---+------++--+++-++-+++--++--/ |  /-+++-----+-++++---+-+-++--+--\ |  || ||| || |   |     | | |  | || |||| |
     \++--+-+---+-++--+---+--++----+-+---/      ||  ||| || |||  ||    |/-+-+++-----+-++++---+-+-++--+--+-+--++-+++-++-+---+-----+-+-+--+-++-++++-+---\
      ||  | |/--+-++--+---+-\||    | |          ||  ||| || |||  ||    || | |||     | ||||   | | ||  |  | |  || ||| || |   |     | | |  | || |||| |   |
      ||  | ||  | ||  |   | |||    | |  /-------++--+++-++-+++--++----++-+-+++-----+-++++---+-+-++--+--+-+--++\||| || |   |     | | |  | || |||| |   |
     /++--+-++--+-++--+---+-+++----+-+--+-------++--+++-++-+++--++----++-+-+++\    | ||||   | | || /+--+-+--++++++-++-+---+-----+-+-+\ | || |||| |   |
     |||  | || /+-++--+---+-+++----+-+--+---\   ||  ||| || |||  ||    || | ||||    | ||||   | | || ||  | |  |||||| || |   |     | | || | || |||| |   |
    /+++--+-++-++-++--+---+-+++----+-+--+---+---++--+++-++-+++--++----++-+\||||    | ||||   | | || ||  |/+--++++++-++-+<--+---\ | | || | || |||| |   |
    ||||  | || || ||  |   | |||    | | /+---+---++--+++-++-+++--++----++-++++++----+-++++---+-+-++-++--+++--++++++-++-+---+---+-+\| || | || |||| |   |
    |||| /+-++-++-++--+---+-+++----+-+-++---+---++--+++-++-+++--++----++-++++++--\ | ||||   | | || || /+++--++++++-++-+---+---+-+++-++\| || |||| |   |
    |||| ||/++-++-++--+---+-+++----+-+-++-\ |   ||  ||| || ||| /++----++-++++++--+-+-++++---+-+-++-++-++++--++++++-++-+---+---+-+++-++++-++-++++\|   |
    ||\+-+++++-++-+/  |   | |||    | | || | |  /++--+++-++-+++-+++----++-++++++--+-+-++++---+-+-++-++-++++--++++++-++-+---+---+-+++-++++\|| ||||||   |
/---++-+-+++++-++-+---+---+-+++----+-+-++-+-+--+++--+++-++-+++-+++----++-++++++--+-+-++++---+-+-++-++\||||  |||||| || |   |   | ||| ||||||| ||||||   |
|   || | ||||| || |   |   | |||  /-+-+-++-+\|  |||  ||| || ||| |||    || ||||||  | | ||||   | | || |||||||  |||||| || |   |   | ||| ||||||| ||||||   |
|   || | |^||| || |   |   | |||  | | | || |||  |||  ||| || ||| |||    || ||||\+--+-+-++++---+-+-+/ |||||||  |||||| || |   |   | ||| ||||||| ||||||   |
|   || | ||||| || |   |  /+-+++--+-+-+-++-+++--+++--+++-++-+++-+++----++-++++-+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--\| ||| ||||||| ||||||   |
|   || | ||||| || |   |  || |||  | | | || |||  |||  ||| || ||| |||    |\-++++<+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--++-+++-+++++++-++++++---/
|   || | ||||| || |   |  || |||  | | | || |||  |||  ||| ||/+++-+++----+--++++-+--+-+-++++---+-+-+--+++++++--++++++-++-+---+--++\||| ||||||| |v||||
|   || | ||||| \+-+---+--++-+++--+-+-+-++-++/  |||  ||| |||||| |||    |  |||| |  | | ||||   | | |  |||||||  |||||| || |   |  |||||| ||||||| ||||||
|   || | |||||  | |   |  || |||  | | |/++-++---+++--+++-++++++-+++-\  |  |||| |  | | ||||   | | |  |||||||  |||||| || |   |  |||||| ||||||| ||||||
|   || | |||||  | |   |  || |||  | | |||| ||   |||  ||| |||||| ||| |  |  |||| |  | \-++++---+-/ |  |||||||  |||||| || |   |  |||\++-+++++++-+++++/
|   || | |||||  ^ |   |  || |\+--+-+-++++-++---+++--+++-+++++/ ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||| || |   |  ||| || ||||||| |||||
|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||| || |   |  ||| || ||||||| |||||
|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  |||||||  |||||^ || v   |  ||| || ||||||| |||||
|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |  |  |||| |  |   ||||   |   |  ||||||\--++++++-++-+---+--+++-++-+++++++-+++/|
|   || | |||||  | |   |  || | |  | | |||| ||   |||  ||| |||||  ||| |/-+--++++-+--+---++++---+---+--++++++---++++++-++-+---+--+++-++-+++++++-+++-+-\
|   || | ||||| /+-+---+--++-+-+--+-+-++++-++--\|||  ||\-+++++--+++-++-+--++++-+--+---++++---+---+--++++++---+++/|| || | /-+--+++-++-+++++++-+++-+-+--\
|   || | ||||| || |   |  || | |  | | |||| ||  ||||  ||/-+++++--+++-++-+--++++-+-\|   ||||   |   |  ||||||   ||| || || | | |  ||| || ||||||| ||| | |  |
|   || | ||||| || |   |  ||/+-+--+-+-++++-++--++++--+++-+++++--+++-++-+--++++-+-++---++++---+---+--++++++---+++-++-++-+-+\|  ||| || ||||||| ||| | |  |
| /-++-+-+++++-++-+---+--++++-+--+-+-++++-++--++++--+++-+++++--+++-++\|  |||| | ||   ||||   |   |  ||||||   ||| \+-++-+-+++--+++-++-+++++++-++/ | |  |
| | || | ||||| || |   |  |||| |  | | |||| ||/-++++--+++-+++++--+++-++++--++++-+-++---++++--\|   |  ||||||   |||  | || | |||  ||| || ||||||| ||  | |  |
| | || | ||||| || |   |  |||| |  | | |||| ||| ||||  ||| |||||  ||| ||||  |||\-+-++---+++/  ||   |  |||\++---+++--+-++-+-+++--+++-++-++/|||| ||  | |  |
| | || | ||||| || |   |  ||||/+--+-+-++++-+++-++++--+++-+++++--+++-++++--+++--+-++---+++---++---+--+++-++---+++--+-++-+-+++\ ||| || || |||| ||  | |  |
| | || | ||||| || |   |  ||||||  | | |||| ||| ||||  ||| |||||  ||| ||||  |||  | ||   |||   ||   |  \++-++---+++--+-++-+-++++-+++-++-+/ |||| ||  | |  |
| | || | ||||| || \---+--++++++--+-/ |||| ||| |\++--+++-+++++--+++-++++--+++--+-++---+++---++---+---++-++---+++--+-++-+-++++-+++-++-+--+/|| ||  | |  |
| | || | ||||| ||     |  ||||||  |   |||| ||| | \+--+++-+++++--+++-++++--+++--+-++---+++---++---+---++-++---+++--+-++-+-++++-+++-++-+--+-+/ ||  | |  |
| | || | ||||| ||     |  ||||||  |   |||| ||| |  |/-+++-+++++--+++-++++--+++--+-++---+++--\||   |   || ||   |||  | || | |||| ||| || |  | |  ||  | |  |
| | || | ||||| ||     |  ||||||  |   |||| ||| |  || ||| |||||  ||| ||||  \++--+-++---+++--+++---+---++-/|   |||  | || | |||| ||| || |  | |  ||  | |  |
| | || | ||\++-++-----+--++++++--+---++++-/|| |  || ||| |||||  ||| ||||  /++--+-++---+++--+++---+\  ||  |   |||  | || | |||| ||| || |  | |  ||  | |  |
| | || | || || ||     |  ||||||  |   ||||  || |  || ||| |||||  ||| |\++--+++--+-++---+++--+++---++--++--+---+++--+-++-+-++++-+++-++-+--+-+--++--+-/  |
| | || |/++-++-++-----+--++++++--+---++++--++\|  || ||| |||\+--+++-+-++--+++--+-++---+++--+++---++--++--+---+++--+-/| | |||| ||| || |  | |  ||  |    |
| | || |||| || ||     |  ||||||  |   ||\+--++++--++-+++-+++-+--+++-+-++--+++--+-++---+++--+++---++--++--+---+++--+--+-+-++++-+++-/| |  | |  ||  |    |
| | || |||| \+-++-----+--+++++/  |   || |  ||||  || ||| ||| |  ||| | ||  |||  | ||   |||  |||   ||  ||  | /-+++--+--+-+-++++-+++--+\|  | |  ||  |    |
| | || ||||  | ||     |  |||||   |   || |  ||||  \+-+++-+++-+--+++-+-++--+++--+-++---+++--+++---++--++--+-+-+++--/  | | |||| |||  |||  | |  ||  |    |
| | || ||||  | ||     |  |||||   |  /++-+--++++---+\|\+-+++-+--+++-+-+/  |||  | ||   |||  |||   ||  ||  | | |v|     | | |||| |||  |||  | |  ||  |    |
| | || ||||  | ||     |  |||||   |  ||| |  ||||   ||| | ||| |  ||| | |   |||  | ||   ||| /+++---++--++--+-+-+++-----+-+-++++-+++--+++--+-+-\||  |    |
| | || |||\--+-++-----+--+++++---+--+++-+--++++---+++-+-+++-+--+++-+-+---+++--+-++---+++-++++---++--++--+-+-/||     | | |||| |||  |||  | | |||  |    |
| | || |||   | ||     |  |||||   |  ||| |  ||||/--+++-+-+++-+--+++-+-+---+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-+-+++--+---\|
| | || |||   | ||     |  |\+++---+--+++-+--+++++--+++-+-+++-/  ||| | |   |||  | ||   ||| ||||   ||  ||  | |  ||     | | |||| |||  |||  | | |||  |   ||
| | || |||   | ||     |  | |||   |  ||| |  |||||  ||| | |||    ||| | | /-+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-+-+++\ |   ||
| | || |||   | ||     |  | |||   |  ||| |  |||||  ||| | |||    ||\-+-+-+-+++--+-++---+++-++++---++--++--+-+--++-----+-+-++++-+++--+++--+-/ |||| |   ||
| | || |||   | ||/----+--+-+++---+--+++-+--+++++--+++-+-+++----++--+-+-+-+++--+-++---+++-++++---++--++-\| |  ||     | | |||| |||  |||  |   |||| |   ||
| | || |||   | |||    |  | |||   |  ||| |  |||||  ||| | |||    ||  | | | ||| /+-++---+++-++++---++--++-++-+--++-----+-+-++++-+++--+++\ |   |||| |   ||
| | || |||   | \++----+--+-+++---+--+++-+--+++/|  ||| | \++----++--+-+-+-+++-++-++---+++-++++---++--++-++-+--++-----+-+-++++-+++--++++-+---++/| |   ||
| | || |||   |/-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+-+++-++-++---+++-++++---++--++-++-+-\||     | | |||| |||  |||| |   || | |   ||
| | || |||   || ||    |  | |||   |  ||| |  ||| |  ||| |  ||    ||  | | |/+++-++-++---+++-++++--\||  || || | |||     | | |||| |||  |||| |   || | |   ||
| | |\-+++---++-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+++++-+/ ||   ||| ||||  |||  || || | |||     | | |||| |||  |||| |   || | |   ||
| |/+--+++---++-++----+--+-+++---+--+++-+--+++-+--+++-+--++----++--+-+-+++++-+--++---+++-++++\ |||  || || | |||     | | |||| |||  |||| |   || | |   ||
| |||  |||   || ||    | /+-+++---+--+++-+--+++-+--+++-+--++----++-\| | ||||| |  ||   ||| ||||| |||  || || | |||     | | |||| |||  |||| |   || | |   ||
| |||  |||   || ||    | || |||   |  ||| |  ||| |  ||| |  ||    |\-++-+-+++++-+--++---++/ ||||| |||  || || | |||     | | |||| |||  |||| |   || | |   ||
| |||  |||   || ||  /-+-++-+++---+--+++-+-\||| |  ||| |  ||    |  || | |||||/+--++---++--+++++-+++--++-++-+\|||     | | |||| |||  |||| |   || | |   ||
| |||  |||   || ||  | | ||/+++---+--+++-+-++++-+--+++-+-\||    |  || | |||||||  ||   \+--+++++-+++--++-++-+++++-----+-/ |||| |||  ||||/+---++-+-+-\ ||
| |||  |||   || ||  | | ||||||   |  ||| | |||| |  \++-+-+++----+--++-+-+++++++--++----+--+/||| |||  || || |||||     |   |||| |||  ||||||   || | | | ||
| |||  ||v   || ||  | | ||||||   |  ||| | |||| |   || | |||    |  || | \++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--++++++---++-/ | | ||
|/+++--+++---++-++--+-+\||||||   |  ||| | |||| |   || | |||    |  || |  ||||||  ||    |  | ||| |||  || || |||||     |   |||| |||  ||||||   ||   | | ||
|||||  |||   || ||  | ||||||||   |  ||| | |||| |   |\-+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--+++++/   ||   | | ||
|||||  |||   || ||  | \+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+---++++-+++--/||||    ||   | | ||
|||||  |||   || ||  |/-+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++++-----+\  |||| |||   ||||    ||   | | ||
|||||  |||   || \+--++-+++++++---+--+++-+-++++-+---+--+-+++----+--++-+--++++++--++----+--+-+++-+++--++-++-+++/|     ||  |||| |||   ||||    ||   | | ||
|||||  |||   ||  |  || |||||||   |  ||| | |||| |   |  | |||    |  || |  ||||||  ||    |  | ||| |||  || || ||| |     ||  |||| |||   ||||    ||   | | ||
|||||  |||   ||  |  || |||||||   |  |\+-+-++++-+---+--+-+++----+--++-+--++++++--++----/  | ||| |||  || || ||| |     ||  |||| |||   ||||    ||   | | ||
|||||  |||   ||  |  || |||||||   |  \-+-+-++++-+---/  \-+++----+--++-+--++++++--/|       | ||| |\+--++-++-+++-+-----++--++/| |||   ||||    ||   | | ||
||\++--+++---++--+--++-+++++++---+----+-+-++++-+--------+++----+--++-/  ||||||   |   /---+-+++-+-+--++-++-+++-+-----++-\|| |/+++---++++----++--\| | ||
|| ||  |||  /++--+--++-+++++++---+----+-+-++++-+--------+++----+--++----++++++---+---+---+-+++-+-+--++-++-+++-+----\|| ||| |||||   ||||    ||  || | ||
|| ||  |||  |||  |  || |||||||   |    | \-++++-+--------+++----+--++----++++++---+---+---+-+++-+-+--++-++-+++-/    ||| ||| |||||   ||||    ||  || | ||
|| ||  ^\+--+++--+--++-+++++++---+----+---+++/ |        |||    |  ||    ||||||   |   |   | ||| | |  || |\-+++------+++-+++-+++/|   ||||    ||  || | ||
|| ||  | |  |||  |  || |||||||   |    |   |||  |        |||    |  ||    ||||||   |   |   | ||| | |  || |  |||      ||| ||| ||| |   ||||    ||  || | ||
|| ||  | |  |||  |  \+-+++++++---+----+---/||  |        |\+----+--++----++++++---+---+---+-+++-+-+--++-+--+++------+/| ||| ||| |   ||||    ||  || | ||
|| ||  | |  |||  |   | |||||||   |    |    ||  |        | |    |  ||   /++++++---+--\|   | ||| | |  || |  |||      | | ||| ||| |   ||||    ||  || | ||
|| ||  | |  |||  |   \-+++++++---+----+----++--+--------+-+----+--++---+++++++---+--++---+-+++-+-+--++-+--+++------+-/ ||| ||| |   ||||    ||  || | ||
|| ||  \-+--+++--+-----+++++++---+----+----++--+--------+-+----+--++---+++++++---+--++---+-+/| | |  \+-+--+++------+---+++-+++-+---++++----+/  || | ||
|\-++----+--+++--+-----/||||||   |    |    ||  |        | |    |  ||   |||||||   |  |\---+-+-+-+-+---+-+--+++------+---/|| ||| |   ||||    |   || | ||
|  ||    |  |||  |      ||||||   |    |    ||  |        | |    |  ||   ||||||\---+--+----+-+-+-+-+---+-+--+++------+----++-+++-+---++/|    |   || | ||
|  ||    |  |||  |      |\++++---+----+----++--+--------+-+----+--++---++++++----+--+----+-+-+-+-+---+-+--+++------+----++-++/ |   || |    |   || | ||
|  ||    |  |||  |   /--+-++++---+----+----++--+--------+-+----+--++---++++++--\ |  |    | | | | |   | |  |||      |    || ||  |   || |    |   || | ||
|  ||    |  |||  |   |  | ||||   |    |    |\--+--------+-+----+--++---++++++--+-+--+----+-/ | | |   | |  ||v      |    || ||  |   || |    |   || | ||
|  ||    |  |||  \---+--+-++++---+----+----+---+--------+-+----+--++---++++++--+-+--+----+---+-+-+---+-/  |||      |    || ||  |   || |    |   || | ||
|  ||    |  |||      |  | |\++---+----+----+---+--------+-+----+--++---++++++--+-+--+----+---+-+-+---+----+++------+----+/ ||  |   || |    |   || | ||
|  ||    |  |||      |  | | ||   |    |   /+---+--------+-+-\  |  || /-++++++--+-+--+---<+---+-+-+---+----+++------+----+-\||  |   || |    |   || | ||
|  ||    |  |||      |  | | ||   |    |   ||   |        | | |  |  || | ||||\+--+-+--+----+---+-+-+---+----+++------+----+-+++--+---+/ |    |   || | ||
|  ||    |  |||      |  \-+-++---+----+---++---+--------+-+-+--+--/| | |||| |  | |  |    |   | | |   |    |||      |    | |||  |   |  |    |   || | ||
|  ||    |  |\+------+----+-/|   |    |   ||   |        | | |  |   | | |||| |  | |  |    |   | | |   |/---+++------+\   | |||  |   |  |    |   || | ||
|  ||    |  | |      |    |  |   |    |   ||   |        | | |  |   | | |||| |  | |  |    |   | | |   ||   |||      ||   \-+++--+---+--+----+---++-+-+/
|  ||    |  \-+------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---++---+++------/|     |||  |   |  |    |   || | |
|  ||    |    \------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---++---++/       |     |||  |   |  |    |   || | |
\--++----+-----------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-+--+----+---+-+-+---/|   ||        |     |||  |   |  |    |   || | |
   ||    \-----------+----+--+---+----+---++---+--------+-+-+--+---+-+-++++-+--+-/  |    |   | | |    |   ||        |     |||  |   |  |    |   || | |
   ||                |    |  \---+----+---++---+--------+-+-+--+---+-+-++++-+--+----+----+---+-+-+----+---++--------+-----+/|  |   |  |    |   || | |
   ||                |    |      |    |   ||   |        | | |  |   | | |||| |  |    |    \---+-+-+----+---++--------+-----+-+--+---+--+----/   || | |
   |\----------------+----+------+----+---++---+--------+-+-+--+---+-+-+++/ |  |    |        | | |    |   \+--------+-----+-+--+---/  |        || | |
   |        /--------+----+------+----+---++---+----<---+-+-+--+---+-+-+++--+--+----+--------+-+-+----+----+--------+\    | |  |      |        || | |
   |        |        |    |      \----+---+/   |        | | |  |   | | |\+--+--+----+--------+-/ |    |    |        ||    | |  |      |        || | |
   |        |        |    |           |   |    \--------+-+-+--+---+-+-+-+--+--+----+--------+---+----+----+--------++----+-+--+------+--------++-+-/
   \--------+--------+----+-----------+---+-------------+-+-+--+---+-+-+-+--+--+----+--------/   |    |    |        ||    | |  |      |        || |
            |        |    |           |   |             | | |  |   | | \-+--+--+----/            |    |    |        ||    | |  |      |        || |
            |        |    |           |   |             | | |  |   | |   |  |  |                 |    |    |        ||    | \--+------+--------/| |
            |        |    |           \---+-------------+-+-+--+---/ |   |  |  |                 |    \----+--------/|    |    |      |         | |
            |        |    |               |             | | |  |     |   \--+--+-----------------/         |         |    |    |      |         | |
            |        |    |               |             | | |  \-----+------+--+---------------------------+---------+----+----+------+---------/ |
            |        |    |               \-------------+-+-/        |      \--+---------------------------/         |    |    |      |           |
            |        |    |                             | |          \---------+-------------------------------------+----/    |      \-----------/
            \--------+----+-----------------------------+-+--------------------+-------------------------------------/         |
                     \----+----------->-----------------+-+--------------------/                                               |
                          \-----------------------------/ \--------------------------------------------------------------------/
""".trimIndent()

fun solveShit(input: String): Any {
    var state = input
            .split("\n")
            .filter { it != "" };
    var map = state.map {
        it.replace('>', '-')
                .replace('<', '-')
                .replace('^', '|')
                .replace('v', '|')
    }

    var bolids: Set<Pair<Pair<Int, Int>, Pair<Char, Char>>> = setOf();
    for (i in (0..state.size-1)) {
        for (j in (0..state.get(i)!!.length-1)) {
            if (state.get(i)!!.get(j) == '<' || state.get(i)!!.get(j) == '>' || state.get(i)!!.get(j) == '^' || state.get(i)!!.get(j) == 'v') {
                bolids = bolids.plus(Pair(Pair(j, i), Pair(state.get(i)!!.get(j), 'l')));
            }
        }
    }
    var iterations = 1;
    while (true) {
        // printMap(map, bolids);
        var newStateMap = map;
        var newRoundBolids = bolids.map { bolid ->            mapBolid(bolid, newStateMap);     }.toSet();
        var colided = newRoundBolids.filter { it -> bolids.map { bolid -> bolid.first }.contains(it.first) };
        if(colided.size>0){
            System.out.println(colided);
            return iterations

        }

        var byCoords = newRoundBolids.groupBy { it.first }.entries.filter { it.value.size > 1 }
        if(byCoords.size>0){
            System.out.println(byCoords[0]!!.toPair())
            return iterations;
        }

        bolids = newRoundBolids;
        iterations++;
    }
    return iterations;
}

private fun mapBolid(bolid: Pair<Pair<Int, Int>, Pair<Char, Char>>, newStateMap: List<String>): Pair<Pair<Int, Int>, Pair<Char, Char>> {
    var nextField: Char = ' '
    var nextCoords: Pair<Int, Int> = Pair(1,1);
    if (bolid.second.first == '^') {
        nextField = newStateMap.get(bolid.first.second-1)!!.get(bolid.first.first);
        nextCoords = Pair(bolid.first.first , bolid.first.second-1)
    } else if (bolid.second.first == 'v') {
        nextField = newStateMap.get(bolid.first.second+1)!!.get(bolid.first.first );
        nextCoords = Pair(bolid.first.first , bolid.first.second+1)
    } else if (bolid.second.first == '<') {
        nextField = newStateMap.get(bolid.first.second )!!.get(bolid.first.first-1);
        nextCoords = Pair(bolid.first.first-1, bolid.first.second)
    } else if (bolid.second.first == '>') {
        nextField = newStateMap.get(bolid.first.second )!!.get(bolid.first.first+1);
        nextCoords = Pair(bolid.first.first+1, bolid.first.second )
    }

    var nextDir = bolid.second;
    if (nextField == '/') {
        if (bolid.second.first == '>') {
            nextDir = Pair('^', bolid.second.second);
        } else if (bolid.second.first == 'v') {
            nextDir = Pair('<', bolid.second.second);
        } else if (bolid.second.first == '<') {
            nextDir = Pair('v', bolid.second.second);
        } else if (bolid.second.first == '^') {
            nextDir = Pair('>', bolid.second.second);
        }
    } else if (nextField == '\\') {
        if (bolid.second.first == '>') {
            nextDir = Pair('v', bolid.second.second);
        } else if (bolid.second.first == 'v') {
            nextDir = Pair('>', bolid.second.second);
        } else if (bolid.second.first == '<') {
            nextDir = Pair('^', bolid.second.second);
        } else if (bolid.second.first == '^') {
            nextDir = Pair('<', bolid.second.second);
        }
    }else if (nextField == '+') {
        if (bolid.second.first == '>') {
            if (bolid.second.second == 'r') {
                nextDir = Pair('v', 'l');
            } else if (bolid.second.second == 'l') {
                nextDir = Pair('^', 's');
            } else if (bolid.second.second == 's') {
                nextDir = Pair(bolid.second.first, 'r');
            }
        } else if (bolid.second.first == 'v') {
            if (bolid.second.second == 'r') {
                nextDir = Pair('<', 'l');
            } else if (bolid.second.second == 'l') {
                nextDir = Pair('>', 's');
            } else if (bolid.second.second == 's') {
                nextDir = Pair(bolid.second.first, 'r');
            }
        } else if (bolid.second.first == '<') {
            if (bolid.second.second == 'r') {
                nextDir = Pair('^', 'l');
            } else if (bolid.second.second == 'l') {
                nextDir = Pair('v', 's');
            } else if (bolid.second.second == 's') {
                nextDir = Pair(bolid.second.first, 'r');
            }
        } else if (bolid.second.first == '^') {
            if (bolid.second.second == 'r') {
                nextDir = Pair('>', 'l');
            } else if (bolid.second.second == 'l') {
                nextDir = Pair('<', 's');
            } else if (bolid.second.second == 's') {
                nextDir = Pair(bolid.second.first, 'r');
            }
        }

    }

    return Pair(nextCoords, nextDir)
}

fun printMap(map: List<String>, bolids: Set<Pair<Pair<Int, Int>, Pair<Char, Char>>>) {
    for(i in (0..map.size-1)){
        var line = map.get(i)!!;
        bolids.forEach{bolid ->
            run {
                if (bolid.first.second == i) {
                    line = line.replaceRange(bolid.first.first, bolid.first.first + 1, bolid.second.first.toString());
                }
            }
        }
        System.out.println(line)
    }


}

fun main(args: Array<String>) {

    System.out.println(solveShit(input2));

}


